<odoo>
	<data>

		<!-- change layout defined in module nox_crm_lead -->
        <record id="nox_crm_case_form_view_oppor_inherit" model="ir.ui.view">
			<field name="name">crm opportunity - NOX opportunity order</field>
			<field name="model">crm.lead</field>
			<field name="inherit_id" ref="nox_crm_lead.nox_crm_case_form_view_oppor_inherit"/>
			<field name="arch" type="xml">
				<field name="nox_is_startdate" position="replace"/>
				<field name="nox_is_enddate" position="replace"/>
				<field name="nox_is_hourlyrate" position="replace"/>
			</field>
		</record>

        <!-- Opportunity tree view -->
        <record id="nox_crm_case_tree_view_oppor_order" model="ir.ui.view">
            <field name="name">crm opportunity tree - NOX extension Order</field>
            <field name="model">crm.lead</field>
            <field name="inherit_id" ref="nox_crm_lead.nox_crm_case_tree_view_oppor_inherit"/>
            <field name="arch" type="xml">
                <field name="nox_is_hourlyrate" position="attributes">
                    <attribute name="invisible">True</attribute>
                </field>
                <field name="nox_is_hourlyrate" position="after">
                    <field name="nox_sales_hourly_rate"/>
                </field>
            </field>
        </record>

		<!-- Nox Opportunity Order view -->
		<record id="crm_lead_nox_opportunity_order_form" model="ir.ui.view">
            <field name="name">crm.lead.nox.opportunity.order.form</field>
            <field name="model">crm.lead</field>
            <field name="inherit_id" ref="crm.crm_case_form_view_oppor"/>
            <field name="arch" type="xml">
            	<xpath expr="//header[1]" position="inside">
            		<button name="compute_nox_expected_revenue" type="object" string="Calculate Expected Revenue"/>
            	</xpath>
                
                <field name="user_id" position="replace"/>
                <field name="team_id" position="replace"/>

            	<label for="next_activity_id" position="before">
            		<field name="nox_is_startdate"/>
            		<field name="nox_is_enddate"/>
                    <label colspan="2" string=""/>

                    <field name="nox_product1" options="{'no_create': 1}"/>
            		<field name="nox_sales_hourly_rate" attrs="{'invisible': [('nox_product1','=',False)]}"/>
                    <field name="nox_cost_hourly_rate" attrs="{'invisible': [('nox_product1','=',False)]}"/>
					<field name="nox_sum_hours" attrs="{'invisible': [('nox_product1','=',False)]}"/>
            		
    				<field name="nox_ftepercent" widget="progressbar" readonly="1" attrs="{'invisible': [('nox_product1','=',False)]}"/>
    				<label string="" colspan="1"/>
    				<field name="nox_ftepercent_temp" nolabel="1" class="oe_edit_only" colspan="1" attrs="{'invisible': [('nox_product1','=',False)]}"/>

                    <label colspan="2" string=""/>

                    <field name="nox_product2" domain="[('id', '!=', nox_product1)]" options="{'no_create': 1}"/>
                    <field name="nox_sales_hourly_rate2" attrs="{'invisible': [('nox_product2','=',False)]}"/>
                    <field name="nox_cost_hourly_rate2" attrs="{'invisible': [('nox_product2','=',False)]}"/>
                    <field name="nox_sum_hours2" attrs="{'invisible': [('nox_product2','=',False)]}"/>
                    
                    <field name="nox_ftepercent2" widget="progressbar" readonly="1" attrs="{'invisible': [('nox_product2','=',False)]}"/>
                    <label string="" colspan="1"/>
                    <field name="nox_ftepercent_temp2" nolabel="1" class="oe_edit_only" colspan="1" attrs="{'invisible': [('nox_product2','=',False)]}"/>

            	</label>

            	<label for="next_activity_id" position="replace"/>

            	<div class="o_row mr16" position="replace"/>

            	<field name="title_action" position="replace"/>

            	<field name="date_deadline" position="replace"/>

            	<field name="phone" position="after">
                    <label colspan="2" string=""/>
                    
            		<label for="next_activity_id"/>
                    <div>
                        <div class="o_row mr16">
                            <field name="next_activity_id"
                                   options="{'no_create': True, 'no_open': True}"
                                   domain="['|',('team_id','=',False),('team_id','=',team_id)]"/>
                            <span class="oe_form_field"
                                  attrs="{'invisible': ['|', ('next_activity_id', '=', False), ('date_action', '=', False)]}">&#160;on&#160;</span>
                            <field name="date_action" attrs="{'invisible': [('next_activity_id', '=', False)]}" placeholder="Choose a date..."/>
                        </div>
                        <div>
                            <field name="title_action" placeholder="e.g. Discuss proposal"
                               attrs="{'invisible': [('next_activity_id', '=', False)]}"/>
                        </div>
                    </div>
                    <field name="date_deadline"/>

                    <label colspan="2" string=""/>
                    <field name="user_id" context="{'default_groups_ref': ['base.group_user', 'base.group_partner_manager', 'sales_team.group_sale_salesman_all_leads'], 'team_id': team_id}" domain="[('share', '=', False)]"/>
                    <field name="team_id" widget="selection"/>
                </field>

            </field>
        </record>

        <record id="nox_sale_crm_case_form_view_oppor" model="ir.ui.view">
            <field name="name">crm.lead.oppor.inherited.nox</field>
            <field name="model">crm.lead</field>
            <field name="inherit_id" ref="sale_crm.crm_case_form_view_oppor"/>
            <field name="arch" type="xml">
            	<button name="%(sale_crm.sale_action_quotations_new)d" position="attributes">
            		<attribute name="string">Prepare Order</attribute>
            	</button>
            </field>
        </record>

	</data>
</odoo>